# Translation Processor

This Go application automates the translation workflow by:
1. Backing up the current output file
2. Copying the source English file
3. Loading a Traditional Chinese translation map
4. Translating all lines using the map

## Workflow

### Step 1: Backup
Moves `output/global.ini` → `bak/global_bak.ini`

### Step 2: Copy Source
Copies `../source/global.ini` → `output/global.ini`

### Step 3: Load Translation Map
Loads `../init/translation_map_tc.json` into memory as a hash map for O(1) lookups

### Step 4: Translate
Processes each line of `output/global.ini`:
- Extracts the key (left side of `=`)
- Looks up the key in the translation map
- Replaces the value (right side of `=`) with the Chinese translation
- Preserves UTF-8 BOM, formatting, and special markers like `,P`

## Usage

### Run the translator:

```bash
cd process
go run main.go
```

### Build and run:

```bash
cd process
go build -o translator
./translator
```

## Output

The application provides detailed statistics:
- Total lines processed
- Lines successfully translated
- Lines unchanged (no translation found)
- Lines skipped (empty or comments)
- Keys not found in translation map

## Example Output

```
=== Translation Processor ===

✓ Step 1: Backed up output/global.ini to bak/global_bak.ini
✓ Step 2: Copied ../source/global.ini to output/global.ini
✓ Step 3: Loaded 83278 translations from ../init/translation_map_tc.json
✓ Step 4: Translated output/global.ini

=== Translation Complete ===
Total lines processed: 503
Lines translated: 503
Lines unchanged: 0
Lines skipped (empty/comment): 0
Keys not found in map: 0

Output file: output/global.ini
Backup file: bak/global_bak.ini
```

## File Structure

```
process/
├── main.go              # Translation processor
├── go.mod              # Go module file
├── output/             # Contains translated file
│   └── global.ini      # Translated output (Chinese)
└── bak/                # Backup directory
    └── global_bak.ini  # Previous version backup
```

## Features

- **O(1) Translation Lookup**: Hash map for instant key-value lookup
- **UTF-8 BOM Preservation**: Maintains file encoding markers
- **Format Preservation**: Keeps `,P` suffixes and original structure
- **Safe Operation**: Creates temporary file during translation
- **Automatic Backup**: Preserves previous version before processing
- **Detailed Statistics**: Reports on translation coverage

## Integration with init/

This processor uses the translation map generated by `init/main.go`. Make sure to:
1. Run `init/main.go` first to generate `translation_map_tc.json`
2. Then run `process/main.go` to apply translations

## Performance

- Processes 503 lines instantly
- Loads 83,278 translation entries into memory
- 100% translation coverage when all keys are in the map
- Scalable to millions of lines with constant-time lookups